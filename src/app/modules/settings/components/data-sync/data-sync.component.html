<div class="p-4 bg-white rounded shadow-md">
  <div class="flex items-center justify-between">
    <div>
      <p class="text-lg font-semibold">Total Records: {{ totalRecords }}</p>
      <p class="text-lg font-semibold">Progress: {{ progress }}%</p>
      <p class="text-lg font-semibold">Elapsed Time: {{ elapsedTime | number:'1.0-2' }}s</p>
    </div>
    <button class="px-4 py-2 text-white bg-blue-500 rounded hover:bg-blue-700"
      *ngIf="dataSyncAccess?.canSyncODKData && !isDataSyncing" (click)="manualSync()">
      Manual Sync
    </button>
  </div>

  <!-- Progress Bar Section for Data Sync: Show only when data syncing -->
  <div *ngIf="isDataSyncing" class="relative pt-1">
    <div class="flex h-2 mb-4 overflow-hidden text-xs bg-blue-200 rounded">
      <div [style.width.%]="progress"
        class="flex flex-col justify-center text-center text-white bg-blue-500 shadow-none whitespace-nowrap">
      </div>
    </div>
  </div>
</div>

<div class="p-4 mt-4 bg-white rounded shadow-md">
  <div class="flex items-center justify-between">
    <div *ngIf="syncedQuestions && !isQuestionsSyncing">
      {{ syncedQuestions.length ? syncedQuestions.length + ' questions synced.' : 'Click sync ODK questions to sync' }}
    </div>
    <div *ngIf="!syncedQuestions?.length && !syncedQuestions && isQuestionsSyncing">
      Syncing questions ...
      <span class="text-xs italic text-gray-600">(Do not refresh, nor leave this page)</span>
    </div>
    <div class="flex items-center px-4 py-2">
      <label class="inline-flex items-center mt-5" *ngIf="dataSyncAccess?.canSyncODKQuestions">
        <input type="checkbox" class="hidden peer"
          (change)="onForceCheck($event, !syncedQuestions?.length && !syncedQuestions)" [checked]="forceChecked">
        <div class="flex items-center justify-center w-5 h-5 border border-gray-600 rounded hover:cursor-pointer"
          [ngClass]="{
            'opacity-50': !syncedQuestions,
            'hover:cursor-not-allowed': !syncedQuestions?.length && !syncedQuestions,
            'peer-checked:bg-blue-600 peer-checked:border-transparent peer-checked:text-white peer-focus:ring-2 peer-focus:ring-blue-500': syncedQuestions?.length || syncedQuestions,
          }">
          <i class="ph-check" *ngIf="forceChecked"></i>
        </div>
        <span class="ml-2 text-gray-700">Force</span>
      </label>

      <button *ngIf="dataSyncAccess?.canSyncODKQuestions"
        class="px-4 py-2 ml-4 text-white bg-blue-500 rounded hover:bg-blue-700 hover:cursor-pointer" [ngClass]="{
          'opacity-50': !syncedQuestions?.length && !syncedQuestions,
          'hover:cursor-not-allowed': !syncedQuestions?.length && !syncedQuestions,
        }" [disabled]="!syncedQuestions?.length && !syncedQuestions" (click)="onSyncQuestions()">
        Sync ODK Questions
      </button>
    </div>
  </div>

  <!-- Progress bar for syncing questions -->
  <div class="relative pt-1">
    <div class="flex h-2 mt-2 mb-4 overflow-hidden text-xs bg-blue-200 rounded">
      <mat-progress-bar *ngIf="isQuestionsSyncing" mode="indeterminate"></mat-progress-bar>
    </div>
  </div>
</div>
