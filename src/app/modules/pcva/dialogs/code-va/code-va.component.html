<div *ngIf="{
    vaRecord: vaRecord$ | async
} as params">
    <div class="mt-4 ml-4 flex justify-between items-center">
        <div>
            <span class="text-2xl text-start">CODE VA </span>
        </div>
        <div class="mr-4">
            <mat-icon class="cursor-pointer" mat-dialog-close>close</mat-icon>
        </div>
    </div>
    <div class="grid grid-cols-12 p-2">
        <div class="col-span-7 p-4 h-[650px] overflow-auto relative shadow-lg rounded-lg border-1">
            <div class="pt-2 pb-2 sticky top-[-3vh] z-10 bg-white">
                <span class="px-2 text-xl text-start">VA Document </span>
            </div>
            <table class="w-full divide-y divide-gray-200 table-auto">
                <thead class="bg-white sticky top-[-2vh] z-10" *ngIf="params?.vaRecord?.data?.length && odkQuestions?.length">
                    <tr>
                        <th class="px-5 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                           ID 
                        </th>
                        <th class="px-5 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Label
                        </th>
                        <th class="px-5 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Response
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngIf="params?.vaRecord?.data?.length && odkQuestions?.length">
                        
                        <tr *ngFor="let question of odkQuestions; let i = index" [ngClass]="{ 'bg-gray-200': i % 2 !== 0 }">
                            @if(params?.vaRecord?.data[0][question?.key] && question?.key !== 'deviceid'){
                                <td class="px-5 py-3 border-b border-gray-200 text-sm ">
                                    <p class="text-gray-900 whitespace-no-wrap">{{ question?.key }}</p>
                                </td>
                                <td class="px-5 py-3 border-b border-gray-200 text-sm ">
                                    <p class="text-gray-900 whitespace-no-wrap">{{ question?.value?.label }}</p>
                                </td>
                                <td class="px-5 py-3 border-b border-gray-200 text-sm ">
                                    @if(question?.value?.options?.length === 0){
                                        <p class="text-gray-900 whitespace-no-wrap">{{ params?.vaRecord?.data[0][question?.key] }}</p>
                                    } @else {
                                        <ng-container *ngFor="let option of question?.value?.options;">
                                            @if(option.value === params?.vaRecord?.data[0][question?.key]){
                                                <p class="text-gray-900 whitespace-no-wrap">{{ option?.label }}</p>
                                            }
                                        </ng-container>
                                    }
                                </td>
                            }
                        </tr>
                    </ng-container>
                    
                </tbody>
            </table>
            @if(!odkQuestions?.length){
                <table class="table">
                    <tr class="w-full divide-y divide-gray-200 table-auto">
                        <td class="px-5 py-3 border-b border-gray-200 text-sm">
                            <p class="text-gray-900 whitespace-no-wrap text-center">Please, load ODK questions to be able to view this ODK</p>
                        </td>
                    </tr>
                </table>
            }
        </div>
        <div class="col-span-5 p-4 border m-1">
            <div class="sticky top-0 z-10">
                <div class="mt-2">
                    <span class="px-2 text-xl text-start">Coding Sheet </span>
                </div>
                <div class="mt-2">
                    <div class="flex items-center mb-4 gap-4">
                        <label class="block text-sm font-medium text-gray-500 w-1/4">Coder's Name:</label>
                        <input type="text" disabled class="flex-1 p-2 border border-gray-300 rounded-md"
                            placeholder="{{ data?.current_user?.name }}">
                    </div>
                </div>
                <div class=" mt-2 flex items-center mb-4 gap-4">
                    <label class="block text-sm font-medium text-gray-500 w-1/4">Notes:</label>
                    <textarea type="text" class="flex-1 font-sm p-2 border border-gray-300 rounded-md min-h-[80px] max-h-[100px]"
                        placeholder="Doctor's notes."></textarea>
                </div>

                <span class="px-2 text-sm text-start">Part I: Disease or condition directly leading to death</span>

                <div class=" mt-2 flex items-center mb-4 gap-4">
                    <label class="block text-sm font-medium text-gray-500 w-1/4">Notes:</label>
                    <input type="text" class="flex-1 p-2 border border-gray-300 rounded-md min-h-[80px] max-h-[100px]"
                        placeholder="Doctor's notes.">
                </div>
            </div>
        </div>
    </div>

</div>

<!-- 
 -->