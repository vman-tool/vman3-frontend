<div *ngIf="{
    vaRecord: vaRecord$ | async
} as params" class="overflow-hidden">
    <div class="mt-4 ml-4 flex justify-between items-center">
        <div>
            <span class="text-2l text-start">CODE VA </span>
        </div>
        <div class="mr-4">
            <mat-icon class="cursor-pointer" mat-dialog-close>close</mat-icon>
        </div>
    </div>
    <div class="grid grid-cols-12 p-2 border m-1">
        <div class="col-span-6 pl-4 pr-4 pb-4 max-h-[800px] overflow-auto relative shadow-lg rounded-lg border-1">
            <div class="pt-2 pb-2 sticky top-[-6vh] z-10 bg-white">
                <span class="px-2 text-2l text-start">VA Document </span>
            </div>
            <table class="w-full divide-y divide-gray-200 table-auto">
                <thead class="bg-white sticky top-[0vh] z-10" *ngIf="params?.vaRecord?.data?.length && odkQuestions?.length">
                    <tr>
                        <th class="px-5 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                           ID 
                        </th>
                        <th class="px-5 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Label
                        </th>
                        <th class="px-5 py-3 border-b-2 border-gray-200 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider">
                            Response
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <ng-container *ngIf="params?.vaRecord?.data?.length && odkQuestions?.length">
                        
                        <tr *ngFor="let question of odkQuestions; let i = index" [ngClass]="{ 'bg-gray-200': i % 2 !== 0 }">
                            @if(params?.vaRecord?.data[0][question?.key] && question?.key !== 'deviceid'){
                                <td class="px-5 py-3 border-b border-gray-200 text-sm ">
                                    <p class="text-gray-900 whitespace-no-wrap">{{ question?.key }}</p>
                                </td>
                                <td class="px-5 py-3 border-b border-gray-200 text-sm ">
                                    <p class="text-gray-900 whitespace-no-wrap">{{ question?.value?.label }}</p>
                                </td>
                                <td class="px-5 py-3 border-b border-gray-200 text-sm ">
                                    @if(question?.value?.options?.length === 0){
                                        <p class="text-gray-900 whitespace-no-wrap">{{ params?.vaRecord?.data[0][question?.key] }}</p>
                                    } @else {
                                        <ng-container *ngFor="let option of question?.value?.options;">
                                            @if(option.value === params?.vaRecord?.data[0][question?.key]){
                                                <p class="text-gray-900 whitespace-no-wrap">{{ option?.label }}</p>
                                            }
                                        </ng-container>
                                    }
                                </td>
                            }
                        </tr>
                    </ng-container>
                    
                </tbody>
            </table>
            @if(!odkQuestions?.length){
                <table class="table">
                    <tr class="w-full divide-y divide-gray-200 table-auto">
                        <td class="px-5 py-3 border-b border-gray-200 text-sm">
                            <p class="text-gray-900 whitespace-no-wrap text-center">Please, load ODK questions to be able to view this ODK</p>
                        </td>
                    </tr>
                </table>
            }
        </div>
        <div class="col-span-6 max-h-[800px] overflow-auto relative  p-4 border m-1">
            <div class="pt-2 pb-2 sticky top-[-6vh] z-10 bg-white">
                <div class="mt-2">
                    <span class="px-2 text-2l text-start">Coding Sheet </span>
                </div>
                <div class="mt-2">
                    <div class="flex items-center mb-4 gap-4">
                        <label class="block text-sm font-medium text-gray-500 w-1/4">Coder's Name:</label>
                        <input type="text" disabled class="flex-1 p-2 border border-gray-300 rounded-md"
                            placeholder="{{ data?.current_user?.name }}">
                    </div>
                </div>
                
                <form>
                    <table class="w-[100%]">
                        <tbody>
                            <tr class="bg-gray-400">
                                <th colspan="2" class="border border-gray-300 px-4 py-2 text-white text-left">
                                    Administrative Data (can be further specified by country)
                                </th>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-3">Sex:</td>
                                <td class="col-span-3">
                                    <label class="mr-4"><input type="radio" name="sex" class="mr-1"> Female</label>
                                </td>
                                <td class="col-span-3">
                                    <label class="ml-4"><input type="radio" name="sex" class="mr-1"> Male</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="sex" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-3">Date of birth:</td>
                                <td class="col-span-3"><input type="date" class="w-full border px-2 py-1 rounded"></td>
                                <td class="col-span-3 ml-4">Date of death:</td>
                                <td class="col-span-3"><input type="date" class="w-full border px-2 py-1 rounded"></td>
                            </tr>
                            <tr class="bg-gray-400 mt-3">
                                <th colspan="2" class="border border-gray-300 px-4 py-2 text-white text-left">
                                    FRAME A
                                    <br>
                                    <span class="text-sm">
                                        ▶ Medical data: Part 1 and 2
                                    </span>
                                </th>
                            </tr>
                            <tr class="grid grid-cols-12 grid-rows-5">
                                <td class="col-span-4"></td>
                                <td class="col-span-4">Cause of death</td>
                                <td class="col-span-4">Time interval from onset to death</td>
                                <td class="col-span-4 row-span-4">1. Report disease or condition leading to death:</td>
                                <td class="col-span-4 flex">
                                    <label class="mr-4">
                                        a: &nbsp;
                                    </label>
                                    <app-searchable-multi-select
                                        [options]="[{'label': 'Jonas','value': 'Jonas'}, {'label': 'Mwambimbi','value': 'Mwambimbi'}]"
                                        [placeholder]="'Select Disease'"
                                        [multiSelect]="false"
                                    ></app-searchable-multi-select>
                                    
                                </td>
                                <td class="col-span-4">
                                    <input type="text" name="" class="border-[1px] focus:border-[1px] focus:border-gray-400 border-gray-300 w-full mt-[3px] h-[35px] rounded-[3px]" id="">
                                </td>
                                <td class="col-span-4 flex">
                                    <label class="mr-4">
                                        b: &nbsp;
                                    </label>
                                    <app-searchable-multi-select
                                        [options]="[{'label': 'Jonas','value': 'Jonas'}, {'label': 'Mwambimbi','value': 'Mwambimbi'}]"
                                        [placeholder]="'Select Disease'" [multiSelect]="false"></app-searchable-multi-select>
                                </td>
                                <td class="col-span-4">
                                    <input type="text" name=""
                                        class="border-[1px] focus:border-[1px] focus:border-gray-400 border-gray-300 w-full mt-[3px] h-[35px] rounded-[3px]"
                                        id="">
                                </td>
                                <td class="col-span-4 flex">
                                    <label class="mr-4">
                                        c: &nbsp;
                                    </label>
                                    <app-searchable-multi-select
                                        [options]="[{'label': 'Jonas','value': 'Jonas'}, {'label': 'Mwambimbi','value': 'Mwambimbi'}]"
                                        [placeholder]="'Select Disease'" [multiSelect]="false"></app-searchable-multi-select>
                                </td>
                                <td class="col-span-4">
                                    <input type="text" name=""
                                        class="border-[1px] focus:border-[1px] focus:border-gray-400 border-gray-300 w-full h-[40px] rounded-[3px]"
                                        id="">
                                </td>
                                <td class="col-span-4 flex">
                                    <label class="mr-4">
                                        d: &nbsp;
                                    </label>
                                    <app-searchable-multi-select
                                        [options]="[{'label': 'Jonas','value': 'Jonas'}, {'label': 'Mwambimbi','value': 'Mwambimbi'}]"
                                        [placeholder]="'Select Disease'" [multiSelect]="false"></app-searchable-multi-select>
                                </td>
                                <td class="col-span-4">
                                    <input type="text" name=""
                                        class="border-[1px] focus:border-[1px] focus:border-gray-400 border-gray-300 w-full mt-[3px] h-[35px] rounded-[3px]"
                                        id="">
                                </td>
                                <td class="col-span-4">
                                    Other significant conditions contributing to death (time intervals can be included in brackets after the conditions)
                                </td>
                                <td class="col-span-8">
                                    <app-searchable-multi-select
                                        [options]="[{'label': 'Jonas','value': 'Jonas'}, {'label': 'Mwambimbi','value': 'Mwambimbi'}]"
                                        [placeholder]="'Select Disease'" [multiSelect]="true"></app-searchable-multi-select>
                                </td>
                            </tr>
                            <tr class="bg-gray-400 mt-3">
                                <th colspan="2" class="border border-gray-300 px-4 py-2 text-white text-left">
                                    FRAME B
                                    <br>
                                    <span class="text-sm">
                                        ▶ Other medical data
                                    </span>
                                </th>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">Was surgery performed within the last weeks?</td>
                                <td class="col-span-2">
                                    <label class="mr-4"><input type="radio" name="surgery-performed" value="yes" class="mr-1"> Yes</label>
                                </td>
                                <td class="col-span-2">
                                    <label class="ml-4"><input type="radio" name="surgery-performed" value="no" class="mr-1"> No</label>
                                </td>
                                <td class="col-span-2">
                                    <label><input type="radio" name="surgery-performed" value="unknown" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">If yes please specify the date of the surgery</td>
                                <td class="col-span-6">
                                    <input type="date" class="w-full border px-2 py-1 rounded">
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">If yes please specify the reasons of the surgery (disease or condition)</td>
                                <td class="col-span-6">
                                    <textarea class="w-full border px-2 py-1 rounded"></textarea>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">Was an autopsy requested?</td>
                                <td class="col-span-2">
                                    <label class="mr-4"><input type="radio" name="autopsy-requested" value="yes" class="mr-1"> Yes</label>
                                </td>
                                <td class="col-span-2">
                                    <label class="ml-4"><input type="radio" name="autopsy-requested" value="no" class="mr-1"> No</label>
                                </td>
                                <td class="col-span-2">
                                    <label><input type="radio" name="autopsy-requested" value="unknown" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">If yes were the findings used in the certification?</td>
                                <td class="col-span-2">
                                    <label class="mr-4"><input type="radio" name="findings-used" value="yes" class="mr-1"> Yes</label>
                                </td>
                                <td class="col-span-2">
                                    <label class="ml-4"><input type="radio" name="findings-used" value="no" class="mr-1"> No</label>
                                </td>
                                <td class="col-span-2">
                                    <label><input type="radio" name="findings-used" value="unknown" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="mt-3">
                                <th colspan="2" class="text-left">
                                    <span class="text-sm">
                                        ▶ Manner of death
                                    </span>
                                </th>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="Disease" class="mr-1"> Disease</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Assault</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Could not be determined</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Accident</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Legal intervention</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Pending Investigation</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Intentional self harm</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> War</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-3">If external cause or poisoning</td>
                                <td class="col-span-3">
                                    <textarea class="w-full border px-2 py-1 rounded"></textarea>
                                </td>
                                <td class="col-span-3 ml-3">Date of injury: </td>
                                <td class="col-span-3"><input type="date" class="w-full border px-2 py-1 rounded"></td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">Please, describe how external cause occured (If poisoning please specify poisoning agent) </td>
                                <td class="col-span-6">
                                    <textarea class="w-full border px-2 py-1 rounded"></textarea>
                                </td>
                            </tr>
                            <tr class="mt-3">
                                <th colspan="2" class="text-left">
                                    <span class="text-sm">
                                        ▶ Place of occurence of exetrnal cause:
                                    </span>
                                </th>
                            </tr>
                            <tr class="grid grid-cols-12">
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="Disease" class="mr-1"> At home</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Residential Institution</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> School, other institution, public administrative area</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Sports and athletics area</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Street and highway</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Trade and service area</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Industrial and construction area</label>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Farm</label>
                                </td>
                                <td class="col-span-4">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Other place (please specify)</label>
                                </td>
                                <td class="col-span-4 mr-3">
                                    <textarea class="w-full border px-2 py-1 rounded"></textarea>
                                </td>
                                <td class="col-span-3">
                                    <label><input type="radio" name="manner-of-death" value="" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="mt-3">
                                <th colspan="2" class="text-left">
                                    <span class="text-sm">
                                        ▶ Fetal or Infant death:
                                    </span>
                                </th>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">Multiple pregrancy?</td>
                                <td class="col-span-2">
                                    <label class="mr-4"><input type="radio" name="multiple-pregnancy" value="yes" class="mr-1"> Yes</label>
                                </td>
                                <td class="col-span-2">
                                    <label class="ml-4"><input type="radio" name="multiple-pregnancy" value="no" class="mr-1"> No</label>
                                </td>
                                <td class="col-span-2">
                                    <label><input type="radio" name="multiple-pregnancy" value="unknown" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">Stillborn?</td>
                                <td class="col-span-2">
                                    <label class="mr-4"><input type="radio" name="stillborn" value="yes" class="mr-1"> Yes</label>
                                </td>
                                <td class="col-span-2">
                                    <label class="ml-4"><input type="radio" name="stillborn" value="no" class="mr-1"> No</label>
                                </td>
                                <td class="col-span-2">
                                    <label><input type="radio" name="stillborn" value="unknown" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6 flex">
                                    <label for="hrs">
                                        If death within 24hrs specify number of hours survived: 
                                    </label>
                                    <input type="number" name="hrs" class="w-full h-[38px] border rounded">
                                </td>
                                
                                <td class="col-span-6 flex ml-3">
                                    <label for="weight">Birth weight (in grams): </label>
                                    <input type="number" name="weight" class="w-full h-[38px] border rounded">
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6 flex">
                                    <label for="hrs">
                                        Number of completed weeks of pregnancy: 
                                    </label>
                                    <input type="number" name="weeks" class="w-full h-[38px] border rounded">
                                </td>
                                
                                <td class="col-span-6 flex ml-3">
                                    <label for="weight">Age of mother (in years): </label>
                                    <input type="number" name="age" class="w-full h-[38px] border rounded">
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6 flex">
                                    If death was perinatal, please state the conditions of mother that affected  the fetus and newborn 
                                </td>
                                
                                <td class="col-span-6">
                                    <textarea class="w-full border px-2 py-1 rounded"></textarea>
                                </td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2 mt-3">
                                <td colspan="2" class="text-left col-span-6">
                                    <span class="text-sm font-semibold">
                                        ▶ For women, was the deceased pregnant?
                                    </span>
                                </td>
                                <td class="col-span-2">
                                    <label class="mr-4"><input type="radio" name="stillborn" value="yes" class="mr-1"> Yes</label>
                                </td>
                                <td class="col-span-2">
                                    <label class="ml-4"><input type="radio" name="stillborn" value="no" class="mr-1"> No</label>
                                </td>
                                <td class="col-span-2">
                                    <label><input type="radio" name="stillborn" value="unknown" class="mr-1"> Unknown</label>
                                </td>
                                <td class="col-span-6"><label><input type="radio" name="stillborn" value="unknown" class="mr-1"> At time of death</label></td>
                                <td class="col-span-6"><label><input type="radio" name="stillborn" value="unknown" class="mr-1"> Within 42 days before the death</label></td>
                                <td class="col-span-6"><label><input type="radio" name="stillborn" value="unknown" class="mr-1"> Between 43 up to 1 year before death</label></td>
                                <td class="col-span-6"><label><input type="radio" name="stillborn" value="unknown" class="mr-1"> Unknown</label></td>
                            </tr>
                            <tr class="grid grid-cols-12 mt-2">
                                <td class="col-span-6">Did the pregnancy contribute to the death?</td>
                                <td class="col-span-2">
                                    <label class="mr-4"><input type="radio" name="stillborn" value="yes" class="mr-1"> Yes</label>
                                </td>
                                <td class="col-span-2">
                                    <label class="ml-4"><input type="radio" name="stillborn" value="no" class="mr-1"> No</label>
                                </td>
                                <td class="col-span-2">
                                    <label><input type="radio" name="stillborn" value="unknown" class="mr-1"> Unknown</label>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </form>
            </div>
        </div>
    </div>

</div>